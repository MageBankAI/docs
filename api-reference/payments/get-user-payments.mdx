---
title: 'List User Payments'
api: 'GET /user/payments'
description: "Get all payments related to the authenticated user's agents"
---

Retrieves a list of payments where either the sender or receiver is one of the user's agents, with optional filtering by approval status.

## Request Headers

<ParamField header="x-api-key" type="string" required>
  Your API key for authentication
</ParamField>

## Query Parameters

<ParamField query="approvalStatus" type="string">
  Filter payments by approval status
</ParamField>

## Response

Returns an array of payment objects, each containing:

<ResponseField name="id" type="string">
  Unique payment identifier in short ID format
</ResponseField>

<ResponseField name="senderagentid" type="string">
  ID of the agent sending the payment
</ResponseField>

<ResponseField name="receiveragentid" type="string">
  ID of the agent receiving the payment
</ResponseField>

<ResponseField name="initiatedBy" type="string">
  Name of the agent that initiated the payment
</ResponseField>

<ResponseField name="receivedBy" type="string">
  Name of the agent that received the payment
</ResponseField>

<ResponseField name="direction" type="string">
  Direction of the payment relative to the user's agents (incoming, outgoing)
</ResponseField>

<ResponseField name="name" type="string">
  Name or description of the payment
</ResponseField>

<ResponseField name="approvalstatus" type="string">
  Approval status of the payment
</ResponseField>

<ResponseField name="createdat" type="string">
  Timestamp when the payment was created
</ResponseField>

<ResponseField name="type" type="string">
  Type of payment (EXTERNAL, INTERNAL)
</ResponseField>

<ResponseField name="paymentdetails" type="object">
  <Expandable title="properties">
    <ResponseField name="method" type="string">
      Payment method used
    </ResponseField>
    <ResponseField name="amount" type="number">
      Payment amount
    </ResponseField>
    <ResponseField name="currency" type="string">
      Payment currency
    </ResponseField>
  </Expandable>
</ResponseField>

## Example Request

<CodeGroup>

```bash cURL
# Get all payments
curl -X GET "https://api.magebank.ai/user/payments" \
  -H "x-api-key: YOUR_API_KEY"

# Get only payments waiting for approval
curl -X GET "https://api.magebank.ai/user/payments?approvalStatus=Waiting%20for%20Sender%20Approval" \
  -H "x-api-key: YOUR_API_KEY"
```

```javascript Node.js
const axios = require('axios');

async function getUserPayments(approvalStatus = null) {
  try {
    const params = {};
    if (approvalStatus) {
      params.approvalStatus = approvalStatus;
    }
    
    const response = await axios.get('https://api.magebank.ai/user/payments', {
      params: params,
      headers: {
        'x-api-key': 'YOUR_API_KEY'
      }
    });
    
    console.log(`Found ${response.data.length} payments`);
    return response.data;
  } catch (error) {
    console.error('Error retrieving payments:', error.response ? error.response.data : error.message);
    throw error;
  }
}

// Get all payments
getUserPayments();

// Get only payments waiting for approval
getUserPayments('Waiting for Sender Approval');
```

```python Python
import requests

def get_user_payments(approval_status=None):
    url = "https://api.magebank.ai/user/payments"
    headers = {
        "x-api-key": "YOUR_API_KEY"
    }
    
    params = {}
    if approval_status:
        params["approvalStatus"] = approval_status
    
    response = requests.get(url, headers=headers, params=params)
    
    if response.status_code == 200:
        payments = response.json()
        print(f"Found {len(payments)} payments")
        return payments
    else:
        print(f"Error: {response.status_code}")
        print(response.text)
        raise Exception(f"API request failed with status {response.status_code}")

# Get all payments
get_user_payments()

# Get only payments waiting for approval
get_user_payments("Waiting for Sender Approval")
```

</CodeGroup>

## Example Response

```json
[
  {
    "id": "payee_8tJo7vZb1RKo4oeyWuqgK",
    "senderagentid": "agent_8tJo7vZb1RKo4oeyWuqgK",
    "receiveragentid": "agent_7tJo7vZb1RKo4oeyWuqgK",
    "initiatedBy": "Alice",
    "receivedBy": "Bob",
    "direction": "outgoing",
    "name": "Payment from Alice to Bob",
    "approvalstatus": "Approved",
    "createdat": "2025-04-07T12:00:00Z",
    "type": "EXTERNAL",
    "paymentdetails": {
      "method": "CRYPTO_ADDRESS",
      "amount": 100,
      "currency": "USDC"
    }
  },
  {
    "id": "payee_9tJo7vZb1RKo4oeyWuqgK",
    "senderagentid": "agent_7tJo7vZb1RKo4oeyWuqgK",
    "receiveragentid": "agent_8tJo7vZb1RKo4oeyWuqgK",
    "initiatedBy": "Bob",
    "receivedBy": "Alice",
    "direction": "incoming",
    "name": "Payment from Bob to Alice",
    "approvalstatus": "Waiting",
    "createdat": "2025-04-08T10:00:00Z",
    "type": "EXTERNAL",
    "paymentdetails": {
      "method": "CRYPTO_ADDRESS",
      "amount": 50,
      "currency": "USDC"
    }
  }
]
```

## Error Responses

<ResponseExample>
```json 401 Unauthorized
{
  "error": "Invalid or missing API key"
}
```

```json 500 Internal Server Error
{
  "error": "Internal Server Error"
}
```
</ResponseExample>

## Status Codes

| Status Code | Description |
|-------------|-------------|
| 200 | List of payments retrieved successfully |
| 401 | Unauthorized - Invalid or missing API key |
| 500 | Internal Server Error |

## Notes

- The `direction` field indicates whether the payment is incoming or outgoing relative to your agents.
- Payments are sorted by creation date, with the most recent first.
- Valid approval status values include "Approved", "Declined", "Pending", "Waiting", and "Waiting for Sender Approval".
- If no payments match the filter criteria, an empty array will be returned.